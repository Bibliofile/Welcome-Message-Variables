!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.proxy="https://cors-anywhere.herokuapp.com/"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2),o=new Map,s=e=>!/^0$|^false$|^$/i.test(e||""),c=/^\$\w+\s*=/;document.querySelectorAll("script[type=variables]").forEach(e=>{const t=(e.textContent||"").split("\n");for(let e=0;e<t.length;e++){const n=t[e].trim();if(c.test(n)){const e=n.substring(0,n.indexOf("=")).trim(),t=n.substring(n.indexOf("=")+1).trim();o.set(e,t)}}});const i=[],u=document.createTreeWalker(document.querySelector("#messageContent"),NodeFilter.SHOW_TEXT);let l=u.nextNode();for(;l;){const e=l.parentElement;l=u.nextNode(),e&&(e.innerHTML||"").includes("$")&&i.push(e)}r.resolve(o).then(()=>{if(i.forEach(e=>{e.innerHTML=(e.innerHTML||"").replace(/\$\w+/g,e=>o.get(e)||"")}),s(o.get("$debug"))){const e=document.createElement("div");e.style.background="#fff",e.innerHTML="<p>Variables:</p>",document.querySelector("#messageContent").insertAdjacentElement("beforebegin",e);const t=e.appendChild(document.createElement("ul"));o.forEach((e,n)=>{const r=t.appendChild(document.createElement("li"));r.appendChild(document.createElement("strong")).textContent=n,r.appendChild(document.createTextNode(" = ")),r.appendChild(document.createElement("span")).textContent=e})}}).catch(e=>{s(o.get("$debug"))&&alert("Error resolving: "+e.message),console.log(e)})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(3),o=n(4);t.resolve=function(e){return Promise.all([r.resolve,o.resolve].map(t=>t(e)))}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,s){function c(e){try{u(r.next(e))}catch(e){s(e)}}function i(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(c,i)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);t.resolve=function(e){return r(this,void 0,void 0,function*(){const t=e.get("$bhfans_id");if(!t||!/^\d+$/.test(t))return;const n=yield fetch(`${o.proxy}http://blockheadsfans.com/servers/server.php?id=${t}`).then(e=>e.text()),r=(new DOMParser).parseFromString(n,"text/html"),s=e=>{const t=r.querySelector(e);return t&&t.textContent||""};e.set("$bhfans_owner",s('a[href^="profile.php"]')),e.set("$bhfans_votes",s("#votes")),e.set("$bhfans_description",s("#info table:last-child tr:last-child td")),e.set("$bhfans_server",s("#info td:last-child"))})}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,s){function c(e){try{u(r.next(e))}catch(e){s(e)}}function i(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(c,i)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);t.resolve=function(e){return r(this,void 0,void 0,function*(){let t=e.get("$forum_thread");if(!t||!/\d+$/.test(t))return;const n=t.match(/\/t\/.*?\/(\d+)(?:$|\/)/);if(!n)return;t=n[1];const r=yield fetch(`${o.proxy}https://forums.theblockheads.net/t/${t}.json`).then(e=>e.json());e.set("$forum_title",r.title),e.set("$forum_owner",r.details.created_by.username);const s=(new DOMParser).parseFromString(r.post_stream.posts[0].cooked,"text/html");s.querySelectorAll("a").forEach(e=>{const t=e.getAttribute("href")||"";t.startsWith("/")&&(e.href="https://forums.theblockheads.net"+t)}),s.querySelectorAll("img").forEach(e=>{const t=e.getAttribute("src")||"";t.startsWith("/")&&(e.src="https://forums.theblockheads.net"+t)}),e.set("$forum_post",s.body.innerHTML)})}}]);